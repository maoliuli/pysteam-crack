// 1. 拦截所有<a>标签的点击
document.addEventListener('click', function(e) {
    let target = e.target;
    // 向上查找最近的<a>标签
    while (target && target.tagName !== 'A') {
        target = target.parentElement;
        if (!target) return;
    }
    
    if (target.href && !target.hasAttribute('data-no-intercept')) {
        e.preventDefault();
        window.location.href = target.href;
    }
});

// 2. 拦截window.open
const originalOpen = window.open;
window.open = function(url, name, specs) {
    window.location.href = url;
    return null;
};

// 创建按钮
const btn = document.createElement('button');
btn.innerHTML = '传递URL给Python';
btn.style.cssText = `
    position: fixed;
    bottom: 20px;
    right: 20px;
    padding: 10px;
    background: #FF5722;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    z-index: 9999;
`;

// 点击时获取当前 URL 并调用 Python 函数
btn.onclick = () => {
    const currentUrl = window.location.href;
    window.pywebview.api.SteamOutUrl(currentUrl);
};

document.body.appendChild(btn);